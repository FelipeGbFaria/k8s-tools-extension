"use strict";var p=Object.create;var w=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,M=Object.prototype.hasOwnProperty;var $=(e,n)=>{for(var r in n)w(e,r,{get:n[r],enumerable:!0})},u=(e,n,r,c)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of h(n))!M.call(e,o)&&o!==r&&w(e,o,{get:()=>n[o],enumerable:!(c=y(n,o))||c.enumerable});return e};var E=(e,n,r)=>(r=e!=null?p(k(e)):{},u(n||!e||!e.__esModule?w(r,"default",{value:e,enumerable:!0}):r,e)),x=e=>u(w({},"__esModule",{value:!0}),e);var S={};$(S,{activate:()=>b,deactivate:()=>P});module.exports=x(S);var s=E(require("vscode")),d=require("fs"),f=require("path"),v=require("child_process"),t="k8s-tools",a="k8s-tool.sh",m=(e,n)=>new Promise(r=>{let c=(0,v.spawn)((0,f.join)(n,a),e,{cwd:n}),o;c.stderr.on("data",i=>{o=i}),c.on("close",i=>{Number(i)!==0?r({success:!1,error:o}):r({success:!0})})});function b(e){let n=s.commands.registerCommand(`${t}.syncPod`,async()=>{let c=s.workspace.getConfiguration(t),o=c.get("k8s-folder"),i=c.get("syncable-pods");if(!o){s.window.showErrorMessage(`${t}.k8s-folder setting was not defined`);return}if(!(0,d.existsSync)(o)||!(0,d.lstatSync)(o).isDirectory()){s.window.showErrorMessage(`${t}.k8s-folder setting is not a valid directory`);return}if(!(0,d.existsSync)((0,f.join)(o,a))){s.window.showErrorMessage(`${a} not found in ${t}.k8s-folder setting directory`);return}if(!i||i.length===0){s.window.showErrorMessage(`Please provide options in ${t}.syncable-pods`);return}let l=await s.window.showQuickPick(i,{title:"Select pod"});if(!l)return;s.window.showInformationMessage(`Starting sync for ${l}...`);let g=await m(["sync",l],o);g.success?s.window.showInformationMessage(`Sync successfull for ${l}`):s.window.showErrorMessage(g.error)}),r=s.commands.registerCommand(`${t}.redeployAll`,async()=>{let o=s.workspace.getConfiguration(t).get("k8s-folder");if(!o){s.window.showErrorMessage(`${t}.k8s-folder setting was not defined`);return}if(!(0,d.existsSync)(o)||!(0,d.lstatSync)(o).isDirectory()){s.window.showErrorMessage(`${t}.k8s-folder setting is not a valid directory`);return}if(!(0,d.existsSync)((0,f.join)(o,a))){s.window.showErrorMessage(`${a} not found in ${t}.k8s-folder setting directory`);return}s.window.showInformationMessage("Redeploying all components...");let i=await m(["redeploy","all"],o);i.success?s.window.showInformationMessage("Redeploy all successfull"):s.window.showErrorMessage(i.error)});e.subscriptions.push(n,r)}function P(){}0&&(module.exports={activate,deactivate});
